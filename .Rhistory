add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
abline(h=0, lwd=4, col=2)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("A"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
params2 <- c(params, P=40)
eq1 <- findEquilibrium(T1T2_cline_model, y0=c(1,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T1T2_cline_model, y0=c(1200,1200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T1T2_cline_model, y0=c(0,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq4 <- findEquilibrium(T1T2_cline_model, y0=c(1500,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq5 <- findEquilibrium(T1T2_cline_model, y0=c(500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq6 <- findEquilibrium(T1T2_cline_model, y0=c(500,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq7 <- findEquilibrium(T1T2_cline_model, y0=c(1,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq8 <- findEquilibrium(T1T2_cline_model, y0=c(1500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq9 <- findEquilibrium(T1T2_cline_model, y0=c(500,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
flows <- flowField(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
system="two.dim",
state.names=c("Th1 response","Th2 response"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th1 response","Th2 response"),
add.legend=FALSE,
cex.lab=1.5)
legend(x='topleft', legend=c("Th1 nullclines", "Th2 nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("B"), cex=1.5, bty='n')
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq4$ystar[1,1], eq4$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq5$ystar[1,1], eq5$ystar[2,1], cex=2.5)
points(eq6$ystar[1,1], eq6$ystar[2,1], cex=2.5)
points(eq7$ystar[1,1], eq7$ystar[2,1], cex=2.5)
points(eq8$ystar[1,1], eq8$ystar[2,1], cex=2.5)
points(eq9$ystar[1,1], eq9$ystar[2,1], cex=2.5)
## Variation in parasite dose can generate differences in infection duration
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=50, c2=130, C1=50, C2=50, bp=4,Kp=300, a=0.004)
## Start Th1 biased
out10 <- ode(y=c(T1=800,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20 <- ode(y=c(T1=800,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40 <- ode(y=c(T1=800,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80 <- ode(y=c(T1=800,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
## Start balanced
out10.2 <- ode(y=c(T1=500,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20.2 <- ode(y=c(T1=500,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40.2 <- ode(y=c(T1=500,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80.2 <- ode(y=c(T1=500,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
library(out40.2)
tail(out40.2)
plot(out10[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("C1"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Chronicity-Promoting >\nClearance-Promoting", cex=1)
plot(out10.2[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20.2[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40.2[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80.2[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("D1"), cex=1.5, bty='n')
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
abline(h=0, lwd=4, col=2)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("A"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
params2 <- c(params, P=40)
eq1 <- findEquilibrium(T1T2_cline_model, y0=c(1,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T1T2_cline_model, y0=c(1200,1200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T1T2_cline_model, y0=c(0,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq4 <- findEquilibrium(T1T2_cline_model, y0=c(1500,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq5 <- findEquilibrium(T1T2_cline_model, y0=c(500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq6 <- findEquilibrium(T1T2_cline_model, y0=c(500,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq7 <- findEquilibrium(T1T2_cline_model, y0=c(1,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq8 <- findEquilibrium(T1T2_cline_model, y0=c(1500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq9 <- findEquilibrium(T1T2_cline_model, y0=c(500,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
flows <- flowField(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
system="two.dim",
state.names=c("Th1 response","Th2 response"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th1 response","Th2 response"),
add.legend=FALSE,
cex.lab=1.5)
legend(x='topleft', legend=c("Th1 nullclines", "Th2 nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("B"), cex=1.5, bty='n')
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq4$ystar[1,1], eq4$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq5$ystar[1,1], eq5$ystar[2,1], cex=2.5)
points(eq6$ystar[1,1], eq6$ystar[2,1], cex=2.5)
points(eq7$ystar[1,1], eq7$ystar[2,1], cex=2.5)
points(eq8$ystar[1,1], eq8$ystar[2,1], cex=2.5)
points(eq9$ystar[1,1], eq9$ystar[2,1], cex=2.5)
## Variation in parasite dose can generate differences in infection duration
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=50, c2=130, C1=50, C2=50, bp=4,Kp=300, a=0.004)
## Start Th1 biased
out10 <- ode(y=c(T1=800,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20 <- ode(y=c(T1=800,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40 <- ode(y=c(T1=800,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80 <- ode(y=c(T1=800,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
## Start balanced
out10.2 <- ode(y=c(T1=500,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20.2 <- ode(y=c(T1=500,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40.2 <- ode(y=c(T1=500,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80.2 <- ode(y=c(T1=500,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
plot(out10[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("C1"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Chronicity-Promoting >\nClearance-Promoting", cex=1)
plot(out10.2[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20.2[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40.2[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80.2[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("D1"), cex=1.5, bty='n')
params.2 = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=700, c2=0, C1=50, C2=50, bp=4, Kp=250, a=0.004)
## start Th2 biased
out10.3 <- ode(y=c(T1=0,T2=800,P=10), times=seq(0,500,0.1), full_model, params.2)
out20.3 <- ode(y=c(T1=0,T2=800,P=20), times=seq(0,50,0.1), full_model, params.2)
out40.3 <- ode(y=c(T1=0,T2=800,P=40), times=seq(0,50,0.1), full_model, params.2)
out80.3 <- ode(y=c(T1=0,T2=800,P=80), times=seq(0,50,0.1), full_model, params.2)
## start balanced
out10.4 <- ode(y=c(T1=400,T2=400,P=10), times=seq(0,500,0.1), full_model, params.2)
out20.4 <- ode(y=c(T1=400,T2=400,P=20), times=seq(0,50,0.1), full_model, params.2)
out40.4 <- ode(y=c(T1=400,T2=400,P=40), times=seq(0,50,0.1), full_model, params.2)
out80.4 <- ode(y=c(T1=400,T2=400,P=80), times=seq(0,50,0.1), full_model, params.2)
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
abline(h=0, lwd=4, col=2)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("A"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
params2 <- c(params, P=40)
eq1 <- findEquilibrium(T1T2_cline_model, y0=c(1,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T1T2_cline_model, y0=c(1200,1200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T1T2_cline_model, y0=c(0,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq4 <- findEquilibrium(T1T2_cline_model, y0=c(1500,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq5 <- findEquilibrium(T1T2_cline_model, y0=c(500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq6 <- findEquilibrium(T1T2_cline_model, y0=c(500,1), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq7 <- findEquilibrium(T1T2_cline_model, y0=c(1,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq8 <- findEquilibrium(T1T2_cline_model, y0=c(1500,500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq9 <- findEquilibrium(T1T2_cline_model, y0=c(500,1500), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
flows <- flowField(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
system="two.dim",
state.names=c("Th1 response","Th2 response"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T1T2_cline_model,
xlim=c(0,2100),
ylim=c(0,2100),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th1 response","Th2 response"),
add.legend=FALSE,
cex.lab=1.5)
legend(x='topleft', legend=c("Th1 nullclines", "Th2 nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("B"), cex=1.5, bty='n')
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq4$ystar[1,1], eq4$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq5$ystar[1,1], eq5$ystar[2,1], cex=2.5)
points(eq6$ystar[1,1], eq6$ystar[2,1], cex=2.5)
points(eq7$ystar[1,1], eq7$ystar[2,1], cex=2.5)
points(eq8$ystar[1,1], eq8$ystar[2,1], cex=2.5)
points(eq9$ystar[1,1], eq9$ystar[2,1], cex=2.5)
## Variation in parasite dose can generate differences in infection duration
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=50, c2=130, C1=50, C2=50, bp=4,Kp=300, a=0.004)
## Start Th1 biased
out10 <- ode(y=c(T1=800,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20 <- ode(y=c(T1=800,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40 <- ode(y=c(T1=800,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80 <- ode(y=c(T1=800,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
## Start balanced
out10.2 <- ode(y=c(T1=500,T2=500,P=10), times=seq(0,50,0.1), full_model, params)
out20.2 <- ode(y=c(T1=500,T2=500,P=20), times=seq(0,50,0.1), full_model, params)
out40.2 <- ode(y=c(T1=500,T2=500,P=40), times=seq(0,50,0.1), full_model, params)
out80.2 <- ode(y=c(T1=500,T2=500,P=80), times=seq(0,50,0.1), full_model, params)
plot(out10[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("C1"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Chronicity-Promoting >\nClearance-Promoting", cex=1)
plot(out10.2[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", ylab="Parasite biomass", cex.axis=1.5, cex.lab=1.5)
lines(out20.2[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40.2[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80.2[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("D1"), cex=1.5, bty='n')
params.2 = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=700, c2=0, C1=50, C2=50, bp=4, Kp=250, a=0.004)
## start Th2 biased
out10.3 <- ode(y=c(T1=0,T2=800,P=10), times=seq(0,500,0.1), full_model, params.2)
out20.3 <- ode(y=c(T1=0,T2=800,P=20), times=seq(0,50,0.1), full_model, params.2)
out40.3 <- ode(y=c(T1=0,T2=800,P=40), times=seq(0,50,0.1), full_model, params.2)
out80.3 <- ode(y=c(T1=0,T2=800,P=80), times=seq(0,50,0.1), full_model, params.2)
## start balanced
out10.4 <- ode(y=c(T1=400,T2=400,P=10), times=seq(0,500,0.1), full_model, params.2)
out20.4 <- ode(y=c(T1=400,T2=400,P=20), times=seq(0,50,0.1), full_model, params.2)
out40.4 <- ode(y=c(T1=400,T2=400,P=40), times=seq(0,50,0.1), full_model, params.2)
out80.4 <- ode(y=c(T1=400,T2=400,P=80), times=seq(0,50,0.1), full_model, params.2)
par(mar=c(5, 0.5, 0.5, 4.5))
plot(out10.4[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", yaxt="n", cex.axis=1.5, cex.lab=1.5)
lines(out20.4[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40.4[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80.4[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("C2"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Chronicity-Promoting >\nClearance-Promoting", cex=1)
corners = par("usr") #Gets the four corners of plot area (x1, x2, y1, y2)
par(xpd = TRUE) #Draw outside plot area
text(x = corners[2]+3, y = mean(corners[3:4]), "Initial Th1 Bias", srt = 270, cex=1.5)
text(x = corners[2]+4, y = mean(corners[3:4]), "Initial Th1 Bias", srt = 270, cex=1.5)
par(xpd=FALSE)
plot(out10.3[,c("time","P")], type='l', ylim=c(0,250), xlim=c(0,25), lwd=4, col=gray(0.8), xlab="Age of infection", yaxt='n', cex.axis=1.5, cex.lab=1.5)
axis(2, labels=FALSE, tick=TRUE)
lines(out20.3[,c("time","P")], lwd=4, col=gray(0.6))
lines(out40.3[,c("time","P")], lwd=4, col=gray(0.4))
lines(out80.3[,c("time","P")], lwd=4, col=gray(0.2))
legend(x='topright', legend=c("D2"), cex=1.5, bty='n')
corners = par("usr") #Gets the four corners of plot area (x1, x2, y1, y2)
par(xpd = TRUE) #Draw outside plot area
text(x = corners[2]+4, y = mean(corners[3:4]), "Initial Th2 Bias", srt = 270, cex=1.5)
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
abline(h=0, lwd=4, col=2)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1, lwd=3, col=c(1,2))
legend(x='topright', legend=c("A"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
lines(c(0,2000), c(0,0), col=2, lwd=4)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1, lwd=3, col=c(1,2), bty='n')
legend(x='topright', legend=c("A"), cex=1.5, bty='n')
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
?legend
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
lines(c(0,2000), c(0,0), col=2, lwd=4)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1.25, lwd=2, col=c(1,2), bty='n')
legend(x='topright', legend=c("A"), cex=1.5, bty='n', xjust=1, yjust=1)
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
par("usr")
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
lines(c(0,2000), c(0,0), col=2, lwd=4)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1.25, lwd=2, col=c(1,2), bty='n')
text(x=par("usr")[2], y=par("usr")[4], "A", cex=1.5, xjust=0, yjust=0)
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
?text
text(x=par("usr")[2], y=par("usr")[4], "A", cex=1.5, adj=0)
text(x=par("usr")[2], y=par("usr")[4], "A", cex=1.5, col=2)
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=FALSE)
lines(c(0,2000), c(0,0), col=2, lwd=4)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1.25, lwd=2, col=c(1,2), bty='n')
text(x=450, y=2000, "A", cex=1.5, col=2, adj=1)
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
text(x=450, y=2000, "A", cex=1.5, col=2, adj=0)
text(x=450, y=2000, "A", cex=1.5, col=2)
text(x=400, y=2000, "A", cex=1.5, col=2)
text(x=2000, y=450, "A", cex=1.5, adj=0)
params = c(S1=1000, S2=1000, s1=2000, s2=2000, b1=0.1, b2=0.1, I12=10000, I21=10000, m=0.9, c1=100, c2=130, C1=50, C2=50, bp=4, Kp=300, a=0.004)
params2 <- c(params, T1=800)
eq1 <- findEquilibrium(T2P_cline_model, y0=c(1200,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq2 <- findEquilibrium(T2P_cline_model, y0=c(200,200), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
eq3 <- findEquilibrium(T2P_cline_model, y0=c(700,0), parameters=params2, system="two.dim", plot.it=FALSE, summary=FALSE)
par(mfcol=c(2,3), mar=c(5,5,0.5,0.5), oma=c(0,0,5,0))
flows <- flowField(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
system="two.dim",
col="gray",
state.names=c("Th2 response","Parasite"),
add=FALSE,
cex.axis=1.5,
cex.lab=1.5)
clines <- nullclines(T2P_cline_model,
xlim=c(0,2000),
ylim=c(0,450),
parameters=params2,
col=c(1,2),
lwd=4,
state.names=c("Th2 response","Parasite"),
points=500,
add.legend=TRUE)
lines(c(0,2000), c(0,0), col=2, lwd=4)
legend(x='topleft', legend=c("Th2 nullclines", "P nullclines"), cex=1.25, lwd=2, col=c(1,2), bty='n')
text(x=2000, y=450, "A", cex=1.5, adj=0)
mtext(side=3, line=0.5, "Dynamical Profile of\nImmune-Parasite Interaction", cex=1)
points(eq1$ystar[1,1], eq1$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq2$ystar[1,1], eq2$ystar[2,1], pch=21, bg=1, cex=2.5)
points(eq3$ystar[1,1], eq3$ystar[2,1], cex=2.5)
setwd("~/immunoparasite")
?text
